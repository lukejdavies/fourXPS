\name{obs.Multi.4MOST}
\alias{obs.Multi.4MOST}
%- Also NEED an '\alias' for EACH other topic documented here.
\title{
4MOST mock sbserve a single simulated spectrum with multiple observing conditions (i.e. TExp, airmass, sky brightness)
}
\description{
Function allows the user to provide an input spectrum as generated by make.Sim.Spec and produce multipule mock 4MOST observations with different observing conditions. The resultant observed spectra are returned in a list containing all input observing condtions. These can also be written as FIT files.  
}
\usage{
obs.Multi.4MOST(simName=simName,id=id, EXPSec=EXPSec, NSub=NSub, writeFITSOut = FALSE, airMass = 1.4, IQ = 1.1, skyBright = 21.77, tilt = 6, misAlign = 0.1, ETCPath = "/Users/lukehome/work/ICRAR_work/4MOST/IWG8/Mock_test/4FS-ETC_app/4most2/code/bin/", systemModelDir = "/Users/lukehome/work/ICRAR_work/4MOST/IWG8/Mock_test/4FS-ETC_app/4FS_ETC_system_model_v0.2/", verbose = F)
}
%- maybe also 'usage' for other objects documented here.
\arguments{
  \item{simName}{
Input name of simulation as produced in make.Sim.Spec
}
  \item{id}{
ID of sepctrum in simulation as produced in make.Sim.Spec
}
  \item{EXPSec}{
Exposure times to simulate in sec
}
  \item{NSub}{
Number of sub exposures
}
  \item{writeFITSOut}{
Should resultant spectra be written as FITS. TRUE/FALSE
}
  \item{airMass}{
Air Masses to simulate 
}
  \item{IQ}{
Image quality to simulate
}
  \item{skyBright}{
Sky Brightnesses to simulate (mags/arcsec^2)
}
  \item{tilt}{
Fibre tilts to simulate (mm).
}
  \item{misAlign}{
Fibre mis-allignaments to simulate (mm).
}
  \item{ETCPath}{
Location of 4FS-ETC excecuatable
}
  \item{systemModelDir}{
Path to curretn 4MOST system model
}
  \item{verbose}{
Keep me informed of whats going on! TRUE/FALSE
}
}
\details{
%%  ~~ If necessary, more details than the description above ~~
}
\value{

wave=wave, FluxOrig=FluxOrig2, id=id, sim=simName, z=specZ,band=band,mag=specMag, xunit='ang',yunit='ang', axDat=axDat, Nconditions=length(conditions$col[[8]]), conditions=conditions)


 \item{wave }{Output 4MOST wavelength}
 \item{FluxOrig2 }{Input flux from spectrum, interpolated onto output wavelength scale.}
 \item{id }{Input id of spectrum}
 \item{sim }{Simulation name spectrum}
 \item{z }{Redshift of input spectrum}
 \item{band }{Band of input magnitude}
 \item{mag }{Input magnitude}
 \item{xunit }{xunit of spectrum, see spec.tools/get.spec}
 \item{yunit }{yunit of spectrum, see spec.tools/get.spec}
 \item{axDat }{axDat information for current spectrum, see FITSio/readFITS}
 \item{Nconditions }{Number of conditions simulated}
 \item{conditions }{Nestesd list for condtions}
 \item{conditions$conditionsX }{Nested condition-specific outputs (X is condition number...)}
 \item{conditions$conditionsX$flux }{Output 4MOST observed flux for given condition}
 \item{conditions$conditionsX$error }{Output 4MOST observed error for given condition}
 \item{conditions$conditionsX$ExpSec }{Output 4MOST exposure time for given condition, in seconds}
 \item{conditions$conditionsX$NSub }{Output 4MOST Number of sub exposures for given condition}
 \item{conditions$conditionsX$airmass }{Output 4MOST airmass for given condition}
 \item{conditions$conditionsX$IQ }{Output 4MOST image quality for given condition}
 \item{conditions$conditionsX$skyBright }{Output 4MOST skybrightness for given condition}
 \item{conditions$conditionsX$tilt }{Output 4MOST fibre tilt for given condition}
 \item{conditions$conditionsX$misAlign }{Output 4MOST fibre misallignment for given condition}


}
\references{
%% ~put references to the literature/web site here ~
}
\author{
Luke Davies
}
\note{
%%  ~~further notes~~
}

%% ~Make other sections like Warning with \section{Warning }{....} ~

\seealso{
%% ~~objects to See Also as \code{\link{help}}, ~~~
}
\examples{

# Generate one test spectrum......

SimName<-'TestSim' 
make.Sim.Spec(1, 0.4, 22.0, 'r', 0.76, 10, 1, 'F', res=0.25, passCut=-10.3, simName=SimName)

# Generates four mock 4MOST observations with different exposure times and numbers of sub exposures.

MulitSpec<-obs.Multi.4MOST(simName=SimName, id=1, EXPSec=c(1200,2400,4800, 9600), NSub=c(1,2,4,8), writeFITSOut=FALSE, airMass=1.4, IQ=1.1, skyBright=21.77,tilt=6.0, misAlign=0.1, ETCPath = "/Users/lukehome/work/ICRAR_work/4MOST/IWG8/Mock_test/4FS-ETC_app/4most2/code/bin/", systemModelDir='/Users/lukehome/work/ICRAR_work/4MOST/IWG8/Mock_test/4FS-ETC_app/4FS_ETC_system_model_v0.2/', verbose=F)

# Plots simulated spectra with different exposure times in different colours.

cols<-rainbow(MulitSpec$Nconditions)
for (i in 1:MulitSpec$Nconditions){
  spec<-list(wave=MulitSpec$wave,flux=MulitSpec$conditions[[paste("condition",i,sep='')]]$flux, xunit='ang', yunit='ang', z=MulitSpec$z)
  if (i == 1 ){spec.plot(spec, lwd=0.5,col=cols[i])}
  if (i > 1 ){spec.plot(spec, lwd=0.5,col=cols[i],oplot=T)}
}


}
% Add one or more standard keywords, see file 'KEYWORDS' in the
% R documentation directory.
\keyword{  }
\keyword{  }% __ONLY ONE__ keyword per line
